parameters:
  appuio_cloud_reporting:
    =_metadata:
      multi_instance: true
    namespace: ${_instance}

    images:
      reporting:
        registry: ghcr.io
        repository: appuio/appuio-cloud-reporting
        tag: v0.17.0

    schedules:
      backfill: '15 * * * *'

    schedules_suspend:
      backfill: false

    development_mode: false
    override_sales_order_id: null

    extra_volumes: {}

    prometheus:
      url: null
      org_id: null

    odoo:
      metered_billing_endpoint: null
      oauth:
        token_endpoint: null
        client_id: null
        client_secret: null

    rules: {}

    network_policies:
      target_namespaces: {}

    monitoring:
      enabled: true
      alerts:
        APPUiOCloudReportingDatabaseBackfillingFailed:
          enabled: true
          rule:
            annotations:
              description: APPUiO Cloud Reporting backfilling metrics into reporting database failed.
              message: APPUiO Cloud Reporting backfilling metrics into reporting database failed.
              runbook_url: https://hub.syn.tools/appuio-cloud-reporting/runbooks/APPUiOCloudReportingDatabaseBackfillingFailed.html
              summary: APPUiO Cloud Reporting backfilling metrics into reporting database failed.
            expr: |
              kube_job_failed{job="kube-state-metrics",namespace="${appuio_cloud_reporting:namespace}",job_name=~"backfill-.*"} > 0
            for: 10m
            labels:
              severity: warning